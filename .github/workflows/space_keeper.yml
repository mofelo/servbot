name: ğŸ›¡ï¸ Gradio Space æ¯6å°æ—¶ä¿æ´»

on:
  schedule:
    # æ¯6å°æ—¶è¿è¡Œä¸€æ¬¡ (00:00, 06:00, 12:00, 18:00 UTC)
    - cron: '0 */6 * * *'
  workflow_dispatch:  # å…è®¸æ‰‹åŠ¨è§¦å‘
  push:
    branches: [ main ]

jobs:
  keep-alive:
    runs-on: ubuntu-latest
    timeout-minutes: 8
    
    steps:
    - name: ğŸ“¥ æ£€å‡ºä»£ç 
      uses: actions/checkout@v4
      
    - name: ğŸ è®¾ç½® Python
      uses: actions/setup-python@v5
      with:
        python-version: '3.11'
        
    - name: ğŸ”§ å®‰è£… Chrome
      run: |
        sudo apt-get update
        sudo apt-get install -y wget gnupg
        wget -q -O - https://dl-ssl.google.com/linux/linux_signing_key.pub | sudo apt-key add -
        echo "deb [arch=amd64] http://dl.google.com/linux/chrome/deb/ stable main" | sudo tee /etc/apt/sources.list.d/google-chrome.list
        sudo apt-get update
        sudo apt-get install -y google-chrome-stable
        google-chrome --version
        
    - name: ğŸ“¦ å®‰è£… Python ä¾èµ–
      run: |
        pip install selenium webdriver-manager
        
    - name: ğŸ¯ ä¿æ´» Space
      env:
        HF_SPACE_URL: ${{ secrets.HF_SPACE_URL }}
      run: |
        echo "ğŸš€ å¼€å§‹ä¿æ´»æµç¨‹..."
        echo "ğŸ“ ç›®æ ‡: ${HF_SPACE_URL:-https://ka1q-shang.hf.space}"
        echo "ğŸ• æ—¶é—´: $(date)"
        
        python space_keeper.py "${HF_SPACE_URL:-https://ka1q-shang.hf.space}"
        
    - name: ğŸ“Š è¿è¡ŒæŠ¥å‘Š
      if: always()
      run: |
        echo "âœ… ä¿æ´»ä»»åŠ¡å®Œæˆï¼"
        echo "ğŸ“… æ—¥å¿—æ—¶é—´: $(date)"
